Anomaly Detection with EfficientAD and Patchcore: A Report

Introduction

This notebook explores the application of two state-of-the-art anomaly detection models, EfficientAD and Patchcore, to identify defects in images of various industrial objects. It utilizes the MVTec Anomaly Detection (MVTec AD) dataset, a widely used benchmark for this task.

Models and Methodology-

Two prominent anomaly detection models are employed in this analysis:

EfficientAD: Known for its speed and accuracy, EfficientAD is a deep-learning model designed for real-time anomaly detection. It uses a student-teacher approach to detect both local and global anomalies.

Patchcore: This model utilises a patch-based approach, comparing image patches to a coreset of normal patches to identify anomalies.


Workflow of the notebook-

1) Data Loading: The MVTec AD dataset is loaded, focusing on three categories: tile, grid, and leather.
1) Model Training: Both EfficientAD and Patchcore models are trained separately for each category, using only normal images (anomaly-free).
1) Inference and Evaluation: The trained models are used to predict anomalies on test images. The performance of each model is assessed using the Area Under the Receiver Operating Characteristic Curve (AUROC), a common metric for anomaly detection.
1) Visualization: The results are visualized by displaying the original image, the predicted anomaly map (highlighting anomalous regions), and an overlay of the two.
1) Similarity Search: Qdrant, a vector database, is used to store the anomaly map features. This enables similarity search, allowing you to find images with similar anomaly patterns.

Results and Discussion-

Performance: Both models demonstrated high AUROC scores across the tested categories, indicating their effectiveness in anomaly detection. EfficientAD exhibited higher image AUROC scores and faster processing speeds overall.

Visualization: The anomaly maps generated by both models effectively highlighted the defective areas in the test images.

Similarity Search: The integration of Qdrant facilitated the retrieval of images with similar anomaly patterns, which can be valuable for understanding different types of anomalies.

Conclusion -

This notebook successfully showcased the capabilities of EfficientAD and Patchcore in industrial anomaly detection. EfficientAD stands out for its speed, making it suitable for real-time applications. Patchcore, on the other hand, might be preferred for detecting more localized anomalies. The implementation of similarity search using Qdrant provides a powerful tool for exploring and understanding anomaly patterns in a dataset.
